# ==============================================================================
# CONFIGURACI√ìN DE ENTORNO LOCAL - DEPLOY MANAGER
# ==============================================================================
# Este archivo contiene todas las variables de entorno necesarias para
# ejecutar el stack completo en modo desarrollo local con Docker Compose.
#
# Para usar este archivo:
# 1. Copia este archivo como .env: cp .env.example .env
# 2. Ajusta los valores seg√∫n tus necesidades
# 3. Ejecuta: docker compose up -d
# ==============================================================================

# ==============================================================================
# AUTH SERVICE - Configuraci√≥n del servicio de autenticaci√≥n
# ==============================================================================

# Puerto en el que correr√° el auth-service
PORT=4000

# Clave secreta para JWT y otras operaciones criptogr√°ficas
# IMPORTANTE: Cambia esto en producci√≥n por una clave segura
SECRET=local-secret

# Tiempo de expiraci√≥n de los tokens JWT (formato: 1h, 24h, 7d, etc.)
TOKEN_EXPIRE_IN=24h

# Habilitar documentaci√≥n Swagger en /api
# Valores: true | false
ENABLE_SWAGGER=true

# ==============================================================================
# BASE DE DATOS POSTGRESQL - Auth Service
# ==============================================================================

# Host de la base de datos (localhost para desarrollo, 'db' dentro de Docker)
DB_HOST=localhost

# Puerto de PostgreSQL
DB_PORT=5432

# Credenciales de la base de datos
DB_USERNAME=auth_user
DB_PASSWORD=auth_password
DB_DATABASE=auth-service

# ==============================================================================
# KEYCLOAK - Servidor de identidades OIDC
# ==============================================================================

# URL del emisor de tokens (issuer) - usado para validar tokens JWT
# En desarrollo debe coincidir con la URL desde donde se accede a Keycloak
KC_ISSUER=http://localhost:8080/realms/ally

# ID del cliente configurado en Keycloak para la API
KC_CLIENT_ID=ally-api

# URL para obtener las claves p√∫blicas JWKS para validar tokens
# Dentro de Docker usa 'keycloak:8080', desde fuera 'localhost:8080'
KC_JWKS_URI=http://localhost:8080/realms/ally/protocol/openid-connect/certs

# Usuario de prueba para desarrollo local
# Este usuario se crear√° autom√°ticamente en la base de datos local
KC_TEST_USER_ID=00000000-0000-0000-0000-000000000001
TEST_USER_EMAIL=test@example.com
TEST_USER_PASSWORD=test1234

# ==============================================================================
# MINIO - Almacenamiento de objetos (compatible con Amazon S3)
# ==============================================================================

# Endpoint del servidor MinIO (localhost para desarrollo, 'minio' dentro de Docker)
MINIO_ENDPOINT=localhost

# Puerto de la API de MinIO
MINIO_PORT=9000

# Credenciales de acceso de MinIO
# IMPORTANTE: Cambia estas credenciales en producci√≥n
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123

# Usar SSL para conexiones a MinIO
# Valores: true | false (false para desarrollo local)
MINIO_USE_SSL=false

# Bucket por defecto que se crear√° autom√°ticamente
MINIO_DEFAULT_BUCKET=storage

# ==============================================================================
# CONFIGURACI√ìN GENERAL
# ==============================================================================

# Entorno de ejecuci√≥n
# Valores: development | production | test
NODE_ENV=development

# ==============================================================================
# CONFIGURACI√ìN DE KEYCLOAK (Avanzada)
# ==============================================================================

# Forzar limpieza e importaci√≥n de realms en cada inicio
# √ötil durante desarrollo para resetear configuraci√≥n
# Valores: true | false
KEYCLOAK_IMPORT_FORCE=true

# ==============================================================================
# PUERTOS Y ACCESOS
# ==============================================================================
# 
# Cuando todo est√© ejecut√°ndose, podr√°s acceder a:
#
# üîê Auth Service: http://localhost:4000
#     ‚îî‚îÄ‚îÄ Swagger: http://localhost:4000/api
#
# üóÉÔ∏è  Storage Service: http://localhost:4001
#     ‚îî‚îÄ‚îÄ Swagger: http://localhost:4001/api
#
# üîë Keycloak Admin: http://localhost:8080
#     ‚îî‚îÄ‚îÄ Usuario: admin
#     ‚îî‚îÄ‚îÄ Contrase√±a: admin
#
# üóÑÔ∏è  MinIO Console: http://localhost:9001
#     ‚îî‚îÄ‚îÄ Usuario: minioadmin
#     ‚îî‚îÄ‚îÄ Contrase√±a: minioadmin123
#
# üêò PostgreSQL Auth DB: localhost:5432
#     ‚îî‚îÄ‚îÄ Base de datos: auth-service
#     ‚îî‚îÄ‚îÄ Usuario: auth_user
#     ‚îî‚îÄ‚îÄ Contrase√±a: auth_password
#
# üêò PostgreSQL Keycloak DB: localhost:5433
#     ‚îî‚îÄ‚îÄ Base de datos: keycloak
#     ‚îî‚îÄ‚îÄ Usuario: keycloak
#     ‚îî‚îÄ‚îÄ Contrase√±a: keycloak
#
# üì¶ MinIO API: http://localhost:9000
#
# ==============================================================================
# COMANDOS √öTILES
# ==============================================================================
#
# Levantar todo el stack:
# docker compose up -d
#
# Ver logs de todos los servicios:
# docker compose logs -f
#
# Ver logs de un servicio espec√≠fico:
# docker compose logs -f auth-service
# docker compose logs -f storage-service
# docker compose logs -f minio
# docker compose logs -f keycloak
#
# Detener todo:
# docker compose down
#
# Reiniciar un servicio:
# docker compose restart auth-service
#
# Limpiar todo (incluyendo vol√∫menes):
# docker compose down -v
#
# ==============================================================================
